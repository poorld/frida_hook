ğŸ“¦
8532 /test.js.map
11520 /test.js
4021 /hookM.js.map
5612 /hookM.js
âœ„
{"version":3,"file":"test.js","sourceRoot":"D:/hongda/tools/frida/vscode/","sources":["test.js"],"names":[],"mappings":"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"}
âœ„
/**
 * frida-compile .\test.js -o .\test.bundle.js
 * frida -U xxx -l .\test.bundle.js
 */
// å¯¼å…¥ hookM.js å¯¼å‡ºçš„æ¨¡å—
// import { hookM, hookStack, hookStack, hookMethod, pass, interdict, LOG } from './hookM.js';
import { hookMethod, pass, interdict, LOG } from './hookM.js';
LOG("--- Custom Script Start ---");
let hooksToApply = [
    // --- Mediatek Camera Hooks ---
    {
        enabled: false,
        target: 'com.mediatek.camera.feature.setting.CameraSwitcher#getCamerasFacing',
        callback: (obj, numOfCameras) => {
            console.log("Original mIdList from instance:", obj.mIdList.value);
            const ArrayList = Java.use('java.util.ArrayList');
            const newList = ArrayList.$new();
            newList.add("back");
            newList.add("front");
            return interdict(newList);
        }
    },
    {
        enabled: false,
        target: 'com.mediatek.camera.CameraActivity#onCreateTasks',
        callback: (obj, savedInstanceState) => {
            obj.onCreateTasks(savedInstanceState);
            const View = Java.use('android.view.View');
            const uiOptions = View.SYSTEM_UI_FLAG_IMMERSIVE.value |
                View.SYSTEM_UI_FLAG_HIDE_NAVIGATION.value |
                View.SYSTEM_UI_FLAG_FULLSCREEN.value |
                View.SYSTEM_UI_FLAG_LAYOUT_STABLE.value |
                View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION.value |
                View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN.value;
            let window = obj.getActivity().getWindow();
            let view = window.getDecorView();
            console.log(view);
            console.log('uiOptions', uiOptions);
            view.setSystemUiVisibility(uiOptions);
            obj.getWindow().getDecorView().setSystemUiVisibility(uiOptions);
            return interdict();
        }
    },
    {
        enabled: false,
        target: 'com.mediatek.camera.common.utils.CameraUtil#isTablet',
        callback: () => interdict(false)
    },
    // --- OpenCamera Hooks ---
    {
        enabled: false,
        target: 'net.sourceforge.opencamera.preview.Preview#openCameraCore',
        callback: (obj, p1) => {
            console.log('using_android_l ', obj.using_android_l.value);
            obj.using_android_l.value = true;
            return pass();
        }
    },
    // --- System Server & Framework Hooks ---
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager#interceptKeyBeforeDispatching',
        callback: () => interdict(-1)
    },
    {
        enabled: false,
        target: 'com.android.server.wm.DisplayContent#getOrientation',
        callback: () => interdict(4) // Example: Force an orientation
    },
    {
        enabled: false,
        target: 'com.android.server.wm.DisplayPolicy#requestTransientBars',
        callback: () => interdict()
    },
    {
        enabled: false,
        target: 'com.android.systemui.statusbar.policy.BatteryControllerImpl#fireBatteryLevelChanged',
        callback: (obj) => {
            obj.mLevel.value = 15; // Example: Set battery level
            obj.mPluggedIn.value = false;
            obj.mCharging.value = false;
            return pass();
        }
    },
    // --- Launcher Hooks ---
    {
        enabled: false,
        target: 'com.android.launcher3.model.AddWorkspaceItemsTask#findSpaceForItem',
        callback: () => {
            // Example: Force add item to hotseat
            const intArray = Java.array('int', [-101, 0, 0]);
            return interdict(intArray);
        }
    },
    // --- HLCT Navigation Hooks ---
    {
        enabled: false,
        target: 'me.f1reking.serialportlib.SerialPortHelper#openSafe',
        callback: (obj, arg0, arg1, arg2, arg3, arg4, arg5, arg6) => {
            let res = obj.openSafe(arg0, 115200, arg2, arg3, arg4, arg5, arg6);
            LOG('res=' + res);
            return interdict(res);
        }
    },
    { enabled: false, target: 'com.hlct.navigation.utlis.L$Companion#d' },
    { enabled: false, target: 'com.hlct.navigation.utlis.L$Companion#e' },
    { enabled: false, target: 'com.hlct.navigation.utlis.L$Companion#i' },
    { enabled: false, target: 'com.hlct.navigation.utlis.L$Companion#v' },
    { enabled: false, target: 'com.hlct.navigation.utlis.L$Companion#w' },
    { enabled: false, target: 'com.hlct.navigation.communication.phone.PhoneServer#sendMsg' },
    { enabled: false, target: 'com.hlct.navigation.communication.phone.PhoneServer$openPort$1#onDataReceived' },
    {
        enabled: false,
        target: 'com.android.server.display.DisplayManagerService$BinderService#createVirtualDisplay',
        callback: (obj, virtualDisplayConfig, callback, projection, virtualDevice, dwpc, packageName) => {
            return pass();
        }
    },
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager#sleepDefaultDisplayFromPowerButton',
        callback: (obj) => {
            return pass();
        }
    },
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager#powerPress',
        callback: (obj) => {
            return pass();
        }
    },
    // com.android.server.policy.PhoneWindowManager.shouldHandleShortPressPowerAction
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager#shouldHandleShortPressPowerAction',
        callback: (obj) => {
            return pass();
        }
    },
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager#backKeyPress',
        callback: (obj) => {
            return pass();
        }
    },
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager#interceptKeyBeforeQueueing',
        callback: (obj, event, policyFlags) => {
            let KeyEvent = Java.cast(event, Java.use('android.view.KeyEvent'));
            const targetKeyCode = 4; // KEYCODE_BACK
            const targetScanCode = 158; // BACKé”®çš„å¸¸è§scancode
            let flag = 0;
            let newKeyEvent = KeyEvent.$new(event.getDownTime(), event.getEventTime(), event.getAction(), // ä½¿ç”¨åŸå§‹çš„action (æŒ‰ä¸‹/æŠ¬èµ·)
            targetKeyCode, // [ä¿®æ”¹ç‚¹] ä½¿ç”¨æˆ‘ä»¬ç›®æ ‡çš„KeyCode (BACK)
            event.getRepeatCount(), event.getMetaState(), -1, targetScanCode, // [ä¿®æ”¹ç‚¹] ä½¿ç”¨æˆ‘ä»¬ç›®æ ‡çš„ScanCode
            flag | KeyEvent.FLAG_FROM_SYSTEM.value | KeyEvent.FLAG_VIRTUAL_HARD_KEY.value, 
            // InputDevice.SOURCE_KEYBOARD.value
            257);
            console.log('newKeyEvent', newKeyEvent);
            let context = Java.cast(obj.mContext.value, Java.use('android.content.Context'));
            // let res = obj.interceptKeyBeforeQueueing(newKeyEvent, policyFlags)
            const InputManager = Java.use('android.hardware.input.InputManager');
            const inputManager = context.getSystemService("input");
            let im = Java.cast(inputManager, InputManager);
            /**
             * yuy setSource
             */
            newKeyEvent.setSource(9527);
            im.injectInputEvent(newKeyEvent, InputManager.INJECT_INPUT_EVENT_MODE_ASYNC.value);
            return pass();
        }
    },
    {
        // android.hardware.input.InputManager#injectInputEvent
        enabled: false,
        target: 'android.hardware.input.InputManager#injectInputEvent',
        callback: (obj, event, flag) => {
            let keyEvent = Java.cast(event, Java.use('android.view.KeyEvent'));
            keyEvent.mScanCode.value = 158;
            keyEvent.mFlags.value = 8;
            keyEvent.mMetaState.value = 2097152;
            keyEvent.mSource.value = 769;
            keyEvent.mDisplayId.value = 0;
            console.log('keyEvent', keyEvent);
            let res = obj.injectInputEvent(keyEvent, flag);
            console.log('res', res);
            return interdict(res);
        }
    },
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager#interceptKeyBeforeQueueing',
        callback: (obj, event, policyFlags) => {
            const KeyEvent = Java.use('android.view.KeyEvent');
            let down = event.getAction() == KeyEvent.ACTION_DOWN.value;
            console.log('down', down);
            let res = 0;
            if (down) {
                res = obj.interceptKeyBeforeQueueing(event, 570425345);
            }
            else {
                res = obj.interceptKeyBeforeQueueing(event, 570425344);
            }
            console.log('res', res);
            return interdict(res);
        }
    },
    {
        enabled: false,
        target: 'com.android.server.policy.PhoneWindowManager$PolicyHandler#handleMessage',
        callback: (obj) => {
            return pass();
        }
    },
    {
        enabled: false,
        target: 'com.android.settings.password.ConfirmDeviceCredentialBaseActivity#getConfirmCredentialTheme'
    },
    {
        enabled: false,
        target: 'com.mediatek.camera.common.utils.CameraUtil#findBestMatchPanelSize',
        callback: (obj, sizes, previewRatio, panelWidth, panelHeight) => {
            previewRatio = 2;
            let size = obj.findBestMatchPanelSize(sizes, previewRatio, panelWidth, panelHeight);
            size = Java.cast(size, Java.use('com.mediatek.camera.common.utils.Size'));
            // size.mWidth.value = 1920
            // size.mHeight.value = 1080
            console.log('size', size);
            for (let i = 0; i < sizes.size(); i++) {
                console.log(sizes.get(i));
            }
            return interdict(size);
            // return pass()
        }
    },
    {
        enabled: true,
        target: 'com.mediatek.camera.common.mode.photo.device.PhotoDevice2Controller#getTargetPreviewSize',
        callback: (obj, ratio) => {
            console.log('ratio', ratio);
            let size = obj.getTargetPreviewSize(2);
            console.log(size);
            return interdict(size);
        }
    },
    {
        enabled: true,
        target: 'com.mediatek.camera.common.mode.video.device.v2.VideoDevice2Controller#getSupportedPreviewSizes',
        callback: (obj, ratio) => {
            console.log('ratio', ratio);
            let size = obj.getSupportedPreviewSizes(2);
            console.log(size);
            return interdict(size);
        }
    }
];
/**
 * ===================================================================================
 *                                  HOOK APPLICATION
 * ===================================================================================
 * This section automatically applies all hooks marked as 'enabled: true'.
 * You don't need to modify this part.
 * ===================================================================================
 */
function applyEnabledHooks() {
    LOG("Scanning for enabled hooks...", { subTag: "HookManager" });
    hooksToApply.forEach(hookInfo => {
        if (hookInfo.enabled) {
            const { target, callback, printStack } = hookInfo;
            LOG(`Applying hook to: ${target}`, { subTag: "HookManager" });
            hookMethod(target, callback || null, printStack || false);
        }
    });
    LOG("All enabled hooks have been applied.", { subTag: "HookManager" });
}
// æœ€åï¼Œè°ƒç”¨ applyEnabledHooks æ¥åº”ç”¨æ‰€æœ‰åœ¨é…ç½®ä¸­è¢«å¯ç”¨çš„ Hook
// è¿™ä¼šå¤„ç†ä¸Šé¢é€šè¿‡ `hookM` æ·»åŠ çš„é’©å­ï¼Œä»¥åŠåœ¨ `hooksToApply` ä¸­å¯ç”¨çš„é’©å­ã€‚
applyEnabledHooks();
LOG("--- Custom Script End ---");
âœ„
{"version":3,"file":"hookM.js","sourceRoot":"D:/hongda/tools/frida/vscode/","sources":["hookM.js"],"names":[],"mappings":"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"}
âœ„
/**
 * Frida Hooking Framework
 *
 * A set of helper functions to simplify hooking Java methods on Android with Frida.
 *
 * @version 2.0
 * @author YourName
 *
 * frida -U -f net.sourceforge.opencamera -l .\hookM.js
 * frida -f -U "Open Camera" -l .\hookM.js
 */
// æ—¥å¿—å·¥å…·å’Œå¸¸é‡
const Log = Java.use("android.util.Log");
const TAG = "[FRIDA_SCRIPT]";
const TYPE = {
    INTERDICT: 0,
    PASS: 1 // æ”¾è¡Œå¹¶è°ƒç”¨åŸæ–¹æ³•
};
// è¿”å›å€¼æ„é€ å™¨
const createResult = (type, obj = null) => ({ return_type: type, return_obj: obj });
const pass = () => createResult(TYPE.PASS);
const interdict = (obj) => createResult(TYPE.INTERDICT, obj);
/**
 * ç»Ÿä¸€çš„æ—¥å¿—å‡½æ•°
 * @param {string} message - è¦è®°å½•çš„æ¶ˆæ¯
 * @param {object} [options] - é…ç½®é¡¹
 * @param {string} [options.tag=TAG] - Logcat æ ‡ç­¾
 * @param {'log'|'warn'|'error'} [options.level='log'] - æ—¥å¿—çº§åˆ«
 * @param {string} [options.subTag=''] - æ—¥å¿—å­æ ‡ç­¾ï¼Œä¼šåŠ åœ¨æ¶ˆæ¯å‰é¢
 */
function LOG(message, { tag = TAG, level = 'log', subTag = '' } = {}) {
    const fullMessage = subTag ? `${subTag}: ${message}` : message;
    console[level](fullMessage);
    const logcatLevel = level === 'error' ? 'e' : 'v';
    Log[logcatLevel](tag, fullMessage);
}
/**
 * æ‰“å°è°ƒç”¨æ ˆ
 * @param {string} [message='StackTrace'] - æ‰“å°è°ƒç”¨æ ˆæ—¶é™„å¸¦çš„æ¶ˆæ¯
 */
function printStackTrace(message = 'StackTrace') {
    const stack = Log.getStackTraceString(Java.use("java.lang.Throwable").$new());
    LOG(`${message}:\n${stack}`, { level: 'log' });
}
/**
 * é€šç”¨ Hook å‡½æ•° (æ ¸å¿ƒ)
 * @param {string} classAndMethod - è¦ Hook çš„ç±»å’Œæ–¹æ³•ï¼Œæ ¼å¼ä¸º "com.example.MyClass#myMethod"
 * @param {(thisArg: object, ...args: any[]) => object|void} [callback=null] - å›è°ƒå‡½æ•°ï¼Œå¤„ç†å‚æ•°å’Œè¿”å›å€¼ã€‚å¦‚æœè¿”å› interdict(value)ï¼Œåˆ™æ‹¦æˆªæ–¹æ³•è°ƒç”¨ã€‚
 * @param {boolean} [printStack=false] - æ˜¯å¦æ‰“å°è°ƒç”¨æ ˆ
 */
function hookMethod(classAndMethod, callback = null, printStack = false) {
    if (!classAndMethod.includes('#')) {
        LOG(`Invalid format for hookMethod: "${classAndMethod}". Expected "className#methodName".`, { level: 'error' });
        return;
    }
    const [className, methodName] = classAndMethod.split('#');
    Java.perform(() => {
        let clazz;
        try {
            clazz = Java.use(className);
        }
        catch (e) {
            LOG(`Failed to load class "${className}": ${e}`, { level: 'error' });
            return;
        }
        if (!clazz[methodName] || !clazz[methodName].overloads) {
            LOG(`Method "${methodName}" not found or has no overloads in class "${className}".`, { level: 'warn' });
            // å¯ä»¥åœ¨è¿™é‡Œæ‰“å°æ‰€æœ‰å¯ç”¨æ–¹æ³•ä»¥ä¾›è°ƒè¯•
            // LOG(`Available methods: ${Object.keys(clazz).join(', ')}`);
            return;
        }
        LOG(`Hooking [${classAndMethod}] with ${clazz[methodName].overloads.length} overloads.`);
        clazz[methodName].overloads.forEach((overload, i) => {
            overload.implementation = function (...args) {
                if (printStack) {
                    printStackTrace(`Call to ${classAndMethod}`);
                }
                const logInfo = {
                    hookInfo: `${classAndMethod} [overload ${i}]`,
                    args: args.map(arg => arg?.toString() ?? 'null'),
                    return: 'N/A'
                };
                let resultFromCallback;
                if (callback) {
                    try {
                        resultFromCallback = callback(this, ...args);
                    }
                    catch (e) {
                        LOG(`Error in callback for ${classAndMethod}: ${e.stack}`, { level: 'error' });
                        // Callback å‡ºé”™ï¼Œç»§ç»­æ‰§è¡ŒåŸæ–¹æ³•
                    }
                }
                let retval;
                if (resultFromCallback && resultFromCallback.return_type === TYPE.INTERDICT) {
                    // æ‹¦æˆªè°ƒç”¨
                    retval = resultFromCallback.return_obj;
                    logInfo.return = `[INTERDICTED] ${retval?.toString() ?? 'null'}`;
                }
                else {
                    // æ”¾è¡Œï¼Œè°ƒç”¨åŸæ–¹æ³•
                    try {
                        retval = overload.apply(this, args);
                        logInfo.return = retval?.toString() ?? 'null';
                    }
                    catch (e) {
                        LOG(`Error calling original method ${classAndMethod}: ${e.stack}`, { level: 'error' });
                        throw e; // å°†åŸå§‹å¼‚å¸¸æŠ›å‡ºï¼Œé¿å…åº”ç”¨è¡Œä¸ºå¼‚å¸¸
                    }
                }
                LOG(JSON.stringify(logInfo, null, 2));
                // ã€å…³é”®ä¿®å¤ã€‘æ— è®º retval æ˜¯ä»€ä¹ˆå€¼ï¼ˆåŒ…æ‹¬ nullï¼‰ï¼Œéƒ½å¿…é¡»è¿”å›ï¼Œä»¥åŒ¹é…åŸå§‹æ–¹æ³•çš„è¿”å›ç±»å‹
                return retval;
            };
        });
    });
}
// --- ç®€åŒ–ç‰ˆåˆ«åå‡½æ•° ---
/** ç®€å• Hookï¼Œå¯å¸¦å›è°ƒ */
const hookM = (classAndMethod, callback) => hookMethod(classAndMethod, callback, false);
/** Hook å¹¶æ‰“å°è°ƒç”¨æ ˆ */
const hookStack = (classAndMethod, callback) => hookMethod(classAndMethod, callback, true);
/** ä»…è¿½è¸ªæ–¹æ³•è°ƒç”¨ï¼ˆä¸å¸¦å›è°ƒï¼‰*/
const trace = (classAndMethod) => hookMethod(classAndMethod, null, false);
/** è¿½è¸ªæ–¹æ³•è°ƒç”¨å¹¶æ‰“å°è°ƒç”¨æ ˆ */
const traceStack = (classAndMethod) => hookMethod(classAndMethod, null, true);
// å¯¼å‡ºæ¨¡å— (ä½¿ç”¨æ ‡å‡†çš„ ES Module è¯­æ³•)
export { LOG, printStackTrace, hookMethod, hookM, hookStack, trace, traceStack, pass, interdict };